<div class="row mx-3 mt-3">
  <div class="col-7">
    <div class="d-flex justify-content-start gap-3 align-items-center mb-3">
      <h3 class="mb-0"><%= @component.name %></h3>
      <%= link_to "Edit this Component", chat_path(@component.chat), class: "btn btn-primary rounded-3" %>
      <%= link_to "Return to Components", project_components_path(@component.project), class: "btn btn-primary rounded-3" %>
    </div>
    <% if @component.bootstrap %>
      <iframe srcdoc="<!DOCTYPE html>
        <html lang='en'>
          <head>
            <meta charset='UTF-8'>
            <meta name='viewport' content='width=device-width, initial-scale=1.0'>
            <link href='https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css' rel='stylesheet' integrity='sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH' crossorigin='anonymous'>
            <style>
              <% if @component.css_code.present?  %>
                <%= @component.css_code %>
              <% end %>
            </style>
          </head><body>
            <%= @component.html_code.gsub(/href="#"/, 'href="javascript:void(0)"') %>
            <script src='https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js' integrity='sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz' crossorigin='anonymous'></script>
          </body>
        </html>" style="width: 100%; height: 300px; border: 1px solid #ddd; border-radius: 8px;"></iframe>
    <% else %>
      <iframe src="<%= preview_project_component_path(@project, @component) %>"
        style="width: 100%; height: 400px; border: 1px solid #ccc; border-radius: 8px;">
      </iframe>
    <% end %>
  </div>
  <div class="col-5 code-card">
    <nav class="d-flex justify-content-between align-items-center">
      <div class="nav nav-tabs" id="nav-tab" role="tablist">
        <button class="code-nav nav-link active" id="nav-html-tab" data-bs-toggle="tab" data-bs-target="#nav-html" type="button" role="tab" aria-controls="nav-html" aria-selected="true">HTML</button>
        <button class="code-nav nav-link" id="nav-css-tab" data-bs-toggle="tab" data-bs-target="#nav-css" type="button" role="tab" aria-controls="nav-css" aria-selected="false">CSS</button>
      </div>
    </nav>
    <div class="tab-content" id="nav-tabContent">
      <div class="tab-pane fade show active" id="nav-html" role="tabpanel" aria-labelledby="nav-html-tab" tabindex="0">
        <div data-controller="copy" class="d-flex flex-column">
          <button
          data-action="copy#copy"
          data-copy-target="button"
          class="btn btn-sm btn-secondary align-self-end m-2"
          style="width: fit-content;"
        >
            <i class="bi bi-clipboard"></i> Copy HTML
          </button>
          <pre data-copy-target="source"><code class="language-html"><%= h @formatted_html %></code></pre>
        </div>
      </div>
      <div class="tab-pane fade" id="nav-css" role="tabpanel" aria-labelledby="nav-css-tab" tabindex="0">
        <div data-controller="copy" class="d-flex flex-column">
          <button
          data-action="copy#copy"
          data-copy-target="button"
          class="btn btn-sm btn-secondary align-self-end m-2"
          style="width: fit-content;"
        >
            <i class="bi bi-clipboard"></i> Copy CSS
          </button>
          <pre data-copy-target="source"><code class="language-css"><%= @formatted_css %></code></pre>
        </div>
      </div>
    </div>
  </div>
</div>
